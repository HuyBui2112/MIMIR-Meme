# Use cu121 wheels from the official PyTorch index (prevents pip from pulling CPU wheels)
--extra-index-url https://download.pytorch.org/whl/cu121

# PyTorch core (CUDA 12.1)
torch==2.3.1+cu121
torchvision==0.18.1+cu121
torchaudio==2.3.1+cu121

# Transformers & vision-language
transformers==4.44.2
accelerate==0.34.2
timm==1.0.3
einops==0.8.0
sentencepiece==0.2.0

# Base numeric stack (pin <2.0 to satisfy faiss/thinc; pillow <11 for gradio)
numpy==1.26.4
Pillow==10.4.0
opencv-python==4.10.0.84

# Captioning (BLIP via HF; LAVIS optional – manual install on Windows/WSL)
# lavis==1.0.2

# Retrieval / RAG
# pyserini==0.43.0             # requires torch>=2.4; enable if bạn chấp nhận nâng torch
faiss-cpu==1.8.0.post1         # depends on numpy<2.0 (đã pin 1.26.4)
sentence-transformers==3.2.0
rank-bm25==0.2.2

# NLP utils
spacy==3.7.5
# spacy-transformers==1.3.4  # conflicts with transformers>=4.41; enable later with a compatible combo
nltk==3.9.1

# Data & training utils
pandas==2.2.3
pyarrow==17.0.0
scikit-learn==1.5.2
mlflow==2.16.2
tensorboard==2.18.0
rich==13.9.2
loguru==0.7.2
pyyaml==6.0.2
python-dotenv==1.0.1

# Serving & Demo
fastapi==0.115.5
uvicorn[standard]==0.32.0
gradio==5.0.2

# Dev
ipykernel==6.29.5
